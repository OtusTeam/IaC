za@za-Vivobook-ASUSLaptop-M3504YA-M3504YA:~/Documents/IaC/2git/les25/yc/infra_drift_yaml$ ./run.sh 
Enter Pulumi passphrase: 
Created stack 'dev'
++ pulumi config set yandex:cloudId b1glq0cg9jigrj5lcp63
++ pulumi config set yandex:folderId b1glf35jjq6imk8i8k4m
++ pulumi config set yandex:zone ru-central1-a
++ pulumi config set cidr 192.168.25.0/25
++ pulumi config set username ubuntu
++ pulumi config set imageId fd85r147n5huljgijb47
++ pulumi config set prefix les25
++ pulumi config
KEY              VALUE
yandex:cloudId   b1glq0cg9jigrj5lcp63
yandex:folderId  b1glf35jjq6imk8i8k4m
yandex:token     [secret]
yandex:zone      ru-central1-a
cidr             192.168.25.0/25
imageId          fd85r147n5huljgijb47
prefix           les25
pub              [secret]
username         ubuntu
++ pulumi up -y
Previewing update (dev):
     Type                             Name                Plan       
 +   pulumi:pulumi:Stack              yc-infra-drift-dev  create     
 +   ├─ yandex:index:VpcNetwork       network             create     
 +   ├─ yandex:index:VpcSubnet        subnet              create     
 +   └─ yandex:index:ComputeInstance  instance            create     

Outputs:
    instance_id    : [unknown]
    instance_name  : "les25-instance-drift"
    instance_nat_ip: [unknown]
    network_id     : [unknown]
    network_name   : "les25-network-drift"
    subnet_id      : [unknown]
    subnet_name    : "les25-subnet-drift"

Resources:
    + 4 to create

Updating (dev):
     Type                             Name                Status              
 +   pulumi:pulumi:Stack              yc-infra-drift-dev  created (50s)       
 +   ├─ yandex:index:VpcNetwork       network             created (3s)        
 +   ├─ yandex:index:VpcSubnet        subnet              created (0.57s)     
 +   └─ yandex:index:ComputeInstance  instance            created (46s)       

Outputs:
    instance_id    : "fhm8mbi5k4g5i30ofu56"
    instance_name  : "les25-instance-drift"
    instance_nat_ip: "93.77.189.252"
    network_id     : "enpc2sfh0l2th5gj4vo8"
    network_name   : "les25-network-drift"
    subnet_id      : "e9b9jprgntck20m1u56r"
    subnet_name    : "les25-subnet-drift"

Resources:
    + 4 created

Duration: 51s

++ pulumi stack output
Current stack outputs (7):
    OUTPUT           VALUE
    instance_id      fhm8mbi5k4g5i30ofu56
    instance_name    les25-instance-drift
    instance_nat_ip  93.77.189.252
    network_id       enpc2sfh0l2th5gj4vo8
    network_name     les25-network-drift
    subnet_id        e9b9jprgntck20m1u56r
    subnet_name      les25-subnet-drift
+++ pulumi stack output subnet_name
++ export SAVED_NAME=les25-subnet-drift
++ SAVED_NAME=les25-subnet-drift
++ read -p 'press any key to subnet update to drift on ...'
press any key to subnet update to drift on ...
+++ pulumi stack output subnet_id
++ yc vpc subnet update --id e9b9jprgntck20m1u56r --folder-id b1glf35jjq6imk8i8k4m --new-name les25-subnet-drifted
done (4s)
id: e9b9jprgntck20m1u56r
folder_id: b1glf35jjq6imk8i8k4m
created_at: "2026-02-17T16:38:28Z"
name: les25-subnet-drifted
network_id: enpc2sfh0l2th5gj4vo8
zone_id: ru-central1-a
v4_cidr_blocks:
  - 192.168.25.0/25
dhcp_options: {}

++ pulumi refresh --preview-only --diff
Previewing refresh (dev):
  pulumi:pulumi:Stack: (same)
    [urn=urn:pulumi:dev::yc-infra-drift::pulumi:pulumi:Stack::yc-infra-drift-dev]
    ~ yandex:index/vpcSubnet:VpcSubnet: (update)
        [id=e9b9jprgntck20m1u56r]
        [urn=urn:pulumi:dev::yc-infra-drift::yandex:index/vpcSubnet:VpcSubnet::subnet]
      ~ name: "les25-subnet-drift" => "les25-subnet-drifted"
Resources:
    ~ 1 to update
    3 unchanged
++ read -p 'press any key to subnet update to drift off ...'
press any key to subnet update to drift off ...
+++ pulumi stack output subnet_id
++ yc vpc subnet update --id e9b9jprgntck20m1u56r --folder-id b1glf35jjq6imk8i8k4m --new-name les25-subnet-drift
done (5s)
id: e9b9jprgntck20m1u56r
folder_id: b1glf35jjq6imk8i8k4m
created_at: "2026-02-17T16:38:28Z"
name: les25-subnet-drift
network_id: enpc2sfh0l2th5gj4vo8
zone_id: ru-central1-a
v4_cidr_blocks:
  - 192.168.25.0/25
dhcp_options: {}

++ pulumi refresh --preview-only --diff
Previewing refresh (dev):
  pulumi:pulumi:Stack: (same)
    [urn=urn:pulumi:dev::yc-infra-drift::pulumi:pulumi:Stack::yc-infra-drift-dev]
Resources:              
    4 unchanged
+++ pulumi stack output instance_nat_ip
++ export IP=93.77.189.252
++ IP=93.77.189.252
++ sleep 10
++ true
++ echo 'Curl http://93.77.189.252/ ...'
Curl http://93.77.189.252/ ...
++ curl -fsS --max-time 30 http://93.77.189.252/
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
++ echo 'curl succeeded, exiting.'
curl succeeded, exiting.
++ break
++ read -p 'press any key to destroy and remove stack ...'
press any key to destroy and remove stack ...
++ pulumi destroy -y
Previewing destroy (dev):
     Type                             Name                Plan       
 -   pulumi:pulumi:Stack              yc-infra-drift-dev  delete     
 -   ├─ yandex:index:ComputeInstance  instance            delete     
 -   ├─ yandex:index:VpcSubnet        subnet              delete     
 -   └─ yandex:index:VpcNetwork       network             delete     

Outputs:
  - instance_id    : "fhm8mbi5k4g5i30ofu56"
  - instance_name  : "les25-instance-drift"
  - instance_nat_ip: "93.77.189.252"
  - network_id     : "enpc2sfh0l2th5gj4vo8"
  - network_name   : "les25-network-drift"
  - subnet_id      : "e9b9jprgntck20m1u56r"
  - subnet_name    : "les25-subnet-drift"

Resources:
    - 4 to delete

Destroying (dev):
     Type                             Name                Status              
 -   pulumi:pulumi:Stack              yc-infra-drift-dev  deleted (0.00s)     
 -   ├─ yandex:index:ComputeInstance  instance            deleted (35s)       
 -   ├─ yandex:index:VpcSubnet        subnet              deleted (5s)        
 -   └─ yandex:index:VpcNetwork       network             deleted (0.57s)     

Outputs:
  - instance_id    : "fhm8mbi5k4g5i30ofu56"
  - instance_name  : "les25-instance-drift"
  - instance_nat_ip: "93.77.189.252"
  - network_id     : "enpc2sfh0l2th5gj4vo8"
  - network_name   : "les25-network-drift"
  - subnet_id      : "e9b9jprgntck20m1u56r"
  - subnet_name    : "les25-subnet-drift"

Resources:
    - 4 deleted

Duration: 42s

The resources in the stack have been deleted, but the history and configuration associated with the stack are still maintained. 
If you want to remove the stack completely, run `pulumi stack rm dev`.
++ pulumi stack rm dev -y -f
Stack 'dev' has been removed!
++ set +x
